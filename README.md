[一、概况](#一概况)

[二、功能说明](#二功能)




# 一、概况
    软件定义无线电台的功能链路包括：
    1：音频输入：含噪声抑制，自动增益控制，获得待处理的音频信号
    2：数字调制：AM，FM，SSB，FSK,PSK,QAM,GMSK等调制和解调算法，亚音频处理等
    3：数字变频：载频选择，中频处理，频率偏移补偿等
    4：工作模式：语音通信，数据传输等
    5：用户界面：频率选择，调制方式选择，实时频谱显示，实时波形显示
    6：辅助功能：频道存储，通信日志，通话录音
    7、硬件接口：与射频前端的通信接口驱动，USB或串口等
    8、抗干扰技术：FHSS跳频,DSSS扩频，自适应均衡

# 二、功能
    软件实现HF、VHF/UHF频段的音频信号调制，或数字调制。
    音频/数据波形，调制后波形和频谱显示     
    AF/FM/SSB调制默认策略：默认采用中频调制
    调制频率手动选择、数字下变频展示
    调制后对应的模拟混频需求显示
    测试功能：模拟信号生成和调制
    
# 三、使用
## 3.1流处理方案（在线处理）实时模式
    上行链路
    麦克风（0-20Khz/44.1KSPS）→ 预处理（0-3.4kHz低通滤波/16KSPS）→ 
    基带调制（生成0中频IQ信号，-5.5K-5.5kHz/16KSPS/2路）→
    【发射DBF：数字移相+幅度加权】→
    数字上变频（上采样→正交载波混频→10Mhz中频/32MSPS,实信号)→ 
    DAC（35MSPS，16位，输出带宽>15Mhz，输出10MHz模拟中频信号）→ 
    模拟混频器（10MHz + 本振 → 目标射频）→ 
    带通滤波器（目标射频频段，抑制杂散）→ 功率放大→ 天线


    下行链路
    天馈线→BPF（目标射频频段，抑制杂波）→LNA→
    模拟混频器（目标射频-共用本振→BPF→10MHz中频）→
    ADC（35MSPS，16位，输入带宽>15Mhz)→数字中频信号（10Mhz/32MSPS）
    数字下变频(正交混频→低通滤波→降采样→0中频基带IQ信号，-5.5K-5.5kHz/16KSPS/2路)→
    【接收DBF：相位补偿+加权合并】→
    数字解调（0-3.4kHz音频/16KSPS）→音频输出（0-3.4kHz音频/44.1KSPS）
## 3.2缓存语音方案（离线处理）非实时模式
    语音缓存：麦克风采集完整语音（PTT或端点检测）→0-20Khz/44.1KSPS音频文件（100ms/200ms重叠切片）
    →频域预处理：→FFT（点数取2^N分组）→截断0~3.4kHz频率分量→
        IFFT转回时域，得到纯净的3.4kHz语音信号→
    基带IQ调制（生成0中频IQ信号，-5.5K-5.5kHz/16KSPS/2路）
    数字上变频：上采样（16KSPS→32MSPS）→正交混频（搬移到10MHz中频）→输出完整的数字中频信号
    DAC→模拟混频、功放、发射流程不变。

    信号缓存：
    ADC采集数字中频信号（10MHz/32MSPS，50ms/100ms50%重叠切片）->中频信号片段
    数字下变频：一次性完成“正交混频（10MHz载波）→ 低通滤波（频域截断替代）→ 降采样”：  
    - 混频：用NCO生成10MHz正交载波，与完整数字中频信号逐点相乘（无需分帧，直接遍历数组）；  
    - 频域截断：对混频后的信号做FFT→ 保留-5.5k~5.5kHz分量（对应基带IQ带宽）→ IFFT转回时域；  
    - 降采样：一次性将32MSPS信号抽取到16KSPS（无需实时抽取器，直接按间隔2000取点）；
    IQ校准：统计完整基带IQ信号的幅度差（如I路均值/Q路均值）和相位偏差→ 一次性补偿（如I路×0.98，Q路×1.02）；
    A路：时频谱显示
    B路：解调：对完整校准后的IQ信号做解调（如FM解调一次性计算所有采样点的相位变化，AM解调一次性提取幅度）；
    语音处理：对解调后的音频信号做FFT→ 截断0~3.4kHz分量（去除高频噪声）→ IFFT转回时域→ 插值到44.1KSPS输出。



    语音场景（带宽 3kHz，AM、SSB（主流）、NBFM（窄带调频）
                    维度	AM（调幅）	        SSB（单边带）	        NBFM（窄带调频）	        备注
    1. 调制核心参数				                                                    基于语音带宽 3kHz 设计
    调制带宽B	        2×3kHz=6kHz（双边带）	    ≈3kHz（单边带）	    2×(2.5kHz+3kHz)=11kHz   NBFM 频偏 Δf 取 2.5kHz（行业标准）
    目标载波频率	    基带 IQ：0Hz（中心）
                    射频：HF/VHF	            同 AM	            同 AM	
    2. 基带 IQ 信号				                                                    复信号（I/Q 两路），格式默认 int16
    频率范围	        [-3kHz, +3kHz]	        [-1.5kHz, +1.5kHz]  [-5.5kHz, +5.5kHz]	围绕 0Hz 分布，带宽 = B
    采样率	        16kHz（过采样≈2.7 倍）	12kHz（过采样≈4 倍）	32kHz（过采样≈2.9 倍）满足 fs≥2×B，优先 2 的整数次幂
    3. 中频参数				                                                        中频选择 10MHz（模拟器件成熟）
    中频频率	        10MHz	                10MHz	            10MHz	            适配 HF/VHF 射频，混频本振易实现
    中频采样率	    20MHz（N=1.25×16kHz）³	12MHz（N=1×12kHz）	32MHz（N=1×32kHz）	N 为 DUC 插值倍数，需满足 fs_IF≥2×(f_IF + B/2)
    4. ADC 规格				                                                        接收端用，适配中频采样
    采样率	        20MSPS	                12MSPS	            32MSPS	            匹配中频采样率
    分辨率	        16 位	                16 位	            16 位	            动态范围 96dB，满足语音需求
    输入带宽	        ≥10MHz	                ≥10MHz	            ≥10MHz	            覆盖 10MHz 中频
    噪声系数（NF）	≤6dB	                ≤5dB⁴	            ≤6dB	            SSB 弱信号多，需更低噪声
    5. DAC 规格				                                                        发射端用，适配中频采样
    采样率	        20MSPS	                12MSPS	            32MSPS	            匹配中频采样率
    分辨率	        16 位	                16 位	            16 位	            避免幅度失真
    输出带宽	        ≥10MHz	                ≥10MHz	            ≥10MHz	            覆盖 10MHz 中频
    无杂散动态范围     ≥60dBc	                ≥65dBc⁴	            ≥60dBc	            SSB 需抑制杂散，避免邻道干扰

    音乐场景（带宽20kHz，仅适配 WBFM（宽带调频），AM（带宽 40kHz，音质差）、SSB（带宽 20kHz，解调失真大）不推荐。
    维度	            WBFM（宽带调频）	        备注
    1. 调制核心参数		                    基于音乐带宽 20kHz 设计
    调制带宽 B	    2×(75kHz+20kHz)=190kHz  WBFM 频偏 Δf 取 75kHz（广播标准）
    目标载波频率	    基带 IQ：0Hz（中心）
    射频             VHF	                    射频优先选择 FM 广播频段，覆盖范围广
    2. 基带 IQ 信号		                    复信号（I/Q 两路），格式 int16
    频率范围	        [-95kHz, +95kHz]	    围绕 0Hz 分布，带宽 = 190kHz
    采样率（fs_base）	500kHz（过采样≈2.6 倍）   满足 fs≥2×190kHz=380kHz，500kHz 为工程常用值
    3. 中频参数		中频选择 20MHz（适配 VHF 射频）
    中频频率（f_IF）	20MHz	                混频本振 = 108MHz-20MHz=88MHz（覆盖 FM 广播最高频）
    中频采样率（fs_IF）1MHz（N=2×500kHz）	    满足 fs_IF≥2×(20MHz + 95kHz)=40.19MHz？修正：实际取 40MHz（N=80×500kHz），避免混叠
    4. ADC 规格		                        接收端用，适配 FM 广播接收
    采样率	        40MSPS	                匹配 40MHz 中频采样率
    分辨率	        16 位	                动态范围 96dB，满足音乐动态需求
    输入带宽	        ≥20MHz	                覆盖 20MHz 中频
    噪声系数（NF）	≤7dB	                音乐信号强度高，对 NF 要求较低
    5. DAC 规格		                        发射端用，适配 FM 广播发射
    采样率	        40MSPS	                匹配 40MHz 中频采样率
    分辨率	        16 位	                避免高频成分失真
    输出带宽	        ≥20MHz	                覆盖 20MHz 中频
    无杂散动态范围     ≥55dBc	                音乐信号杂散可接受范围宽

# 四、版权声明
    # Copyright (c) 2025 Y.MF. All rights reserved.
    #
    # 本代码及相关文档受著作权法保护，未经授权，禁止任何形式的复制、分发、修改或商业使用。
    # 如需使用或修改本代码，请联系版权所有者获得书面许可（联系方式：1428483061@qq.com）。
    #
    # 免责声明：本代码按"原样"提供，不提供任何明示或暗示的担保，包括但不限于对适销性、特定用途适用性的担保。
    # 在任何情况下，版权所有者不对因使用本代码或本代码的衍生作品而导致的任何直接或间接损失承担责任。
    #
    # 项目名称：DigitalRadio
    # 项目仓库：https://github.com/YiMuFeng/DigitalRadio.git
    # 创建时间：2025/10/9 22:36
    # 版权所有者：Y.MF
    # 联系方式：1428483061@qq.com
    # 许可协议：Apache License 2.0
